DutyTwist=Ember.Application.create();var set$=Ember.set;set$(DutyTwist,"Assignment",Ember.Object.extend({person:null,duty:null,round:null}));var set$=Ember.set,get$=Ember.get;set$(DutyTwist,"Duty",Ember.Object.extend({name:""})),get$(DutyTwist,"Duty").reopenClass({find:function(e){return e?this.findAll()[e-1]:this.findAll()},findAll:function(){return this._data||(this._data=get$(get$(DutyTwist,"DATA"),"duties").map(function(e){return get$(DutyTwist,"Duty").create({name:e})}))},count:function(){return get$(this.findAll(),"length")}});var get$=Ember.get,set$=Ember.set;set$(DutyTwist,"Person",Ember.Object.extend({name:"",offset:0,id:Ember.computed(function(){return get$(this,"name").parameterize()}).property("name"),dutyAt:function(e){return get$(DutyTwist,"Schedule").find().dutyAt(e,get$(this,"offset"))},_assignments:Ember.computed(function(){return[]}).property(),findAssignment:function(e){return get$(this,"_assignments")[e]||(get$(this,"_assignments")[e]=get$(get$(DutyTwist,"Schedule").find().findRound(e),"assignments")[get$(this,"offset")])}})),get$(DutyTwist,"Person").reopenClass({find:function(){return this._data||(this._data=get$(get$(DutyTwist,"DATA"),"people").map(function(e,t){return get$(DutyTwist,"Person").create({name:e,offset:t})}))}});var get$=Ember.get,set$=Ember.set;set$(DutyTwist,"Round",Ember.Object.extend({number:0,schedule:null,startTime:Ember.computed(function(){return get$(get$(this,"schedule"),"startTime")+get$(this,"number")*get$(get$(this,"schedule"),"interval")}).property("schedule.startTime","number","schedule.interval"),startsOn:Ember.computed(function(){return new Date(get$(this,"startTime"))}).property("startTime"),assignments:Ember.computed(function(){var e;return e=get$(this,"number"),get$(get$(this,"schedule"),"people").map(function(t){return function(n){return get$(DutyTwist,"Assignment").create({round:t,person:n,duty:n.dutyAt(e)})}}(this))}).property("number","schedule.people.@each")}));var get$=Ember.get,set$=Ember.set;set$(DutyTwist,"Schedule",Ember.Object.extend({startTime:0,interval:6048e5,currentRound:Ember.computed(function(){return Math.floor(((new Date).getTime()-get$(this,"startTime"))/get$(this,"interval"))}).property(),dutyAt:function(e,t){var n;return null==t&&(t=0),n=(e+t)%get$(DutyTwist,"Duty").count()+1,get$(DutyTwist,"Duty").find(n)},_rounds:Ember.computed(function(){return[]}).property(),findRound:function(e){return e=1*e,get$(this,"_rounds")[e]||(get$(this,"_rounds")[e]=get$(DutyTwist,"Round").create({number:e,schedule:this}))},people:Ember.computed(function(){return get$(DutyTwist,"Person").find()}).property(),duties:Ember.computed(function(){return get$(DutyTwist,"Duty").find()}).property()})),get$(DutyTwist,"Schedule").reopenClass({find:function(){return this._data||(this._data=get$(DutyTwist,"Schedule").create({startTime:new Date(get$(get$(DutyTwist,"DATA"),"startDate")).getTime(),interval:24*get$(get$(DutyTwist,"DATA"),"interval")*60*60*1e3}))}});var get$=Ember.get,set$=Ember.set;set$(DutyTwist,"IndexController",get$(Em,"ArrayController").extend({rounds:Ember.computed(function(){var e,t;return t=get$(DutyTwist,"Schedule").find(),e=get$(t,"currentRound"),function(){var t;t=[];for(var n=e-1;e+5>=e-1?e+5>=n:n>=e+5;e+5>=e-1?++n:--n)t.push(n);return t}.apply(this,arguments).map(function(e){return t.findRound(e)})}).property()}));var get$=Ember.get,set$=Ember.set;set$(DutyTwist,"PersonAssignmentController",get$(Em,"ObjectController").extend({previousAssignment:Ember.computed(function(){return get$(get$(this,"model"),"person").findAssignment(get$(get$(get$(this,"model"),"round"),"number")-1)}).property("model.person"),nextAssignment:Ember.computed(function(){return get$(get$(this,"model"),"person").findAssignment(get$(get$(get$(this,"model"),"round"),"number")+1)}).property("model.person")})),Ember.Handlebars.helper("localized-date",function(e){return moment(e).format("D MMM")}),Ember.TEMPLATES.application=Ember.Handlebars.template(function(e,t,n,s,r){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,Ember.Handlebars.helpers),r=r||{};var u,a="";return u=n._triageMustache.call(t,"outlet",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:r}),(u||0===u)&&r.buffer.push(u),r.buffer.push("\n"),a}),Ember.TEMPLATES.index=Ember.Handlebars.template(function(e,t,n,s,r){function u(e,t){var s,r,u,o="";return t.buffer.push("\n        <td>\n          "),r=n["link-to"]||e&&e["link-to"],u={hash:{},hashTypes:{},hashContexts:{},inverse:l.noop,fn:l.program(2,a,t),contexts:[e,e],types:["STRING","ID"],data:t},s=r?r.call(e,"person","",u):d.call(e,"link-to","person","",u),(s||0===s)&&t.buffer.push(s),t.buffer.push("\n        </td>\n      "),o}function a(e,t){var s,r="";return t.buffer.push("\n            "),s=n._triageMustache.call(e,"name",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\n          "),r}function o(e,t){var s,r,u,a="";return t.buffer.push("\n      <tr>\n        <td>"),t.buffer.push(m((r=n["localized-date"]||e&&e["localized-date"],u={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t},r?r.call(e,"startsOn",u):d.call(e,"localized-date","startsOn",u)))),t.buffer.push("</td>\n        "),s=n.each.call(e,"assignments",{hash:{},hashTypes:{},hashContexts:{},inverse:l.noop,fn:l.program(5,i,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\n      </tr>\n    "),a}function i(e,t){var s,r,u,a="";return t.buffer.push("\n          <td>\n            "),r=n["link-to"]||e&&e["link-to"],u={hash:{},hashTypes:{},hashContexts:{},inverse:l.noop,fn:l.program(6,h,t),contexts:[e,e,e],types:["STRING","ID","ID"],data:t},s=r?r.call(e,"person.assignment","person","",u):d.call(e,"link-to","person.assignment","person","",u),(s||0===s)&&t.buffer.push(s),t.buffer.push("\n          </td>\n        "),a}function h(e,t){var s,r="";return t.buffer.push("\n              "),s=n._triageMustache.call(e,"duty.name",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\n            "),r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,Ember.Handlebars.helpers),r=r||{};var p,f="",l=this,d=n.helperMissing,m=this.escapeExpression;return r.buffer.push('<table class="schedule">\n  <thead>\n    <tr>\n      <td></td>\n      '),p=n.each.call(t,{hash:{},hashTypes:{},hashContexts:{},inverse:l.noop,fn:l.program(1,u,r),contexts:[],types:[],data:r}),(p||0===p)&&r.buffer.push(p),r.buffer.push("\n    </tr>\n  </thead>\n  <tbody>\n    "),p=n.each.call(t,"rounds",{hash:{},hashTypes:{},hashContexts:{},inverse:l.noop,fn:l.program(4,o,r),contexts:[t],types:["ID"],data:r}),(p||0===p)&&r.buffer.push(p),r.buffer.push("\n  </tbody>\n</table>\n"),f}),Ember.TEMPLATES.person=Ember.Handlebars.template(function(e,t,n,s,r){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,Ember.Handlebars.helpers),r=r||{};var u,a="";return u=n._triageMustache.call(t,"outlet",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:r}),(u||0===u)&&r.buffer.push(u),r.buffer.push("\n"),a}),Ember.TEMPLATES["person/assignment"]=Ember.Handlebars.template(function(e,t,n,s,r){function u(e,t){t.buffer.push("\n    <\n  ")}function a(e,t){t.buffer.push("\n    index\n  ")}function o(e,t){t.buffer.push("\n    >\n  ")}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,Ember.Handlebars.helpers),r=r||{};var i,h,p,f="",l=this,d=n.helperMissing,m=this.escapeExpression;return r.buffer.push("<nav>\n  "),h=n["link-to"]||t&&t["link-to"],p={hash:{},hashTypes:{},hashContexts:{},inverse:l.noop,fn:l.program(1,u,r),contexts:[t,t,t],types:["STRING","ID","ID"],data:r},i=h?h.call(t,"person.assignment","person","previousAssignment",p):d.call(t,"link-to","person.assignment","person","previousAssignment",p),(i||0===i)&&r.buffer.push(i),r.buffer.push("\n  "),h=n["link-to"]||t&&t["link-to"],p={hash:{},hashTypes:{},hashContexts:{},inverse:l.noop,fn:l.program(3,a,r),contexts:[t],types:["STRING"],data:r},i=h?h.call(t,"index",p):d.call(t,"link-to","index",p),(i||0===i)&&r.buffer.push(i),r.buffer.push("\n  "),r.buffer.push(m((h=n["localized-date"]||t&&t["localized-date"],p={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:r},h?h.call(t,"round.startsOn",p):d.call(t,"localized-date","round.startsOn",p)))),r.buffer.push("\n  "),h=n["link-to"]||t&&t["link-to"],p={hash:{},hashTypes:{},hashContexts:{},inverse:l.noop,fn:l.program(5,o,r),contexts:[t,t,t],types:["STRING","ID","ID"],data:r},i=h?h.call(t,"person.assignment","person","nextAssignment",p):d.call(t,"link-to","person.assignment","person","nextAssignment",p),(i||0===i)&&r.buffer.push(i),r.buffer.push("\n</nav>\n<h1>"),i=n._triageMustache.call(t,"duty.name",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:r}),(i||0===i)&&r.buffer.push(i),r.buffer.push("</h1>\n"),f}),function(){DutyTwist.Router.map(function(){return this.route("person",{path:":person_id/"},function(){return this.route("assignment",{path:":round_number"})})})}.call(this);var get$=Ember.get,set$=Ember.set;set$(DutyTwist,"IndexRoute",get$(Em,"Route").extend({model:function(){return get$(DutyTwist,"Person").find()}}));var get$=Ember.get,set$=Ember.set;set$(DutyTwist,"PersonAssignmentRoute",get$(Em,"Route").extend({model:function(e){return this.modelFor("person").findAssignment(get$(e,"round_number"))},serialize:function(e){return{round_number:get$(get$(e,"round"),"number")}}}));var get$=Ember.get,set$=Ember.set;set$(DutyTwist,"PersonRoute",get$(Em,"Route").extend({model:function(e){return get$(DutyTwist,"Person").find().findBy("id",get$(e,"person_id"))},afterModel:function(e){return this.transitionTo("person.assignment",e,get$(get$(DutyTwist,"Schedule").find(),"currentRound"))}}));